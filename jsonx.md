# The Library JsonX

<meta name="description" content="The library JsonX can be used to create well formatted JSON strings. This page explains how it can be used.">

In this page:

* [Introduction](#introduction)
* [Library Structure](#library-structure)
* [Usage Example](#usage-example)
* [Adding Extra Properties](#adding-extra-properties)
* [Working With Arrays](#working-with-arrays)
  * [Adding Arrays as Objects](#adding-arrays-as-objects)
    * [Example 1: Indexed Array as Object](#example-1-indexed-array-as-object)
    * [Example 2: Associative Array as Object](#example-2-associative-array-as-object)
    * [Example 3: Indexed and Associative Array as Object](#example-3-indexed-and-associative-array-as-object)
* [Working With Objects](#working-with-objects)
* [Converting JSON String to JsonX](#converting-json-string-to-jsonx)
* [Properties Style](#properties-style)

## Introduction

When desining web services, the developer must deside on the format at which the server will send back to the client after processing the request. One of the most widely used format is called [JSON](https://www.json.org/json-en.html). PHP does provide functions for encoding and decoding JSON using the methods [`json_encode()`](https://www.php.net/manual/en/function.json-encode.php). And [`json_decode()`](https://www.php.net/manual/en/function.json-decode.php). Since the framework promots the use of OOP approach, it uses a library called [`JsonX`](https://github.com/usernane/jsonx) to create well formatted JSON output.

## Library Structure

The lirary has only one class and one interface. The class [`JsonX`](https://webfiori.com/docs/jsonx/JsonX) is the core of the library. This class is the one which is used to create the final JSON output. In addition to that, it can be used to parse JSON strings and convert them to `JsonX` objects. 

The interface [`JsonI`](https://webfiori.com/docs/jsonx/JsonI) can be used to customize JSON representation of objects which implement it when encoded. The interface has only one method which is [`JsonI::toJSON()`](https://webfiori.com/docs/jsonx/JsonI#toJSON).

## Usage Examples

The following code sample shows the most basic use case. What we do here is simply adding a set of key/value pairs to be represented as JSON.

``` php
$jsonxObj = new JsonX([
    'first-name' => 'Ibrahim',
    'last-name' => 'BinAlshikh',
    'age' => 26,
    'is-married' => true,
    'mobile-number' => null
]);
```

The JSON output that will be generated by the given code will be similiar to the following JSON:

``` json
{
    "first-name":"Ibrahim",
    "last-name":"BinAlshikh",
    "age":26,
    "is-married":true,
    "mobile-number":null
}
```

In addition to initializing your data using the consructor, it is possible to add more properties using one of the methods which can be used to add extra properties.

### Adding Extra Properties

The method [`JsonX::add()`](https://webfiori.com/docs/jsonx/JsonX#add) can be used to add numbers, strings or objects to your JSON.

``` php 
$jsonxObj = new JsonX();
$jsonxObj->add('first-name', 'Ibrahim');
$jsonxObj->add('number', 45);
$jsonxObj->add('another-number', 1.667);
$jsonxObj->add('boolean', true);
$jsonxObj->add('array', ['hello',77,88]);
$jsonxObj->add('another-array', ['Bad',null, false]);   
```

``` json 
{
    "first-name":"Ibrahim", 
    "number":45, 
    "another-number":1.667, 
    "boolean":true, 
    "array":[
        "hello", 
        77, 
        88
    ], 
    "another-array":[
        "Bad", 
        null, 
        false
    ]
}
```

In addition to the method [`JsonX::add()`](https://webfiori.com/docs/jsonx/JsonX#add), there are other methods which are specific for adding specific types:

* [`JsonX::addArray()`](https://webfiori.com/docs/jsonx/JsonX#addArray). Used to add arrays.
* [`JsonX::addBoolean()`](https://webfiori.com/docs/jsonx/JsonX#addBoolean). Used to add boolean value (`true` or `false`).
* [`JsonX::addNumber()`](https://webfiori.com/docs/jsonx/JsonX#addNumber). Used to add numbers (integers or floats).
* [`JsonX::addObject()`](https://webfiori.com/docs/jsonx/JsonX#addObject). Used to add PHP objects.

## Working With Arrays

Arrays in PHP language can be associative, indexed or a mix of the two. When adding arrays to an instance of `JsonX`, the type of the array must be put into consideration. When adding the array using the method [`JsonX::add()`](https://webfiori.com/docs/jsonx/JsonX#add), It will be added as array. But there is one thing that must be noted. If the array is a mix between indexed and associative, the indices which are associative will be converted to objects.

``` php
$jsonxObj = new JsonX();
$arr = [
    "one", 
    "two", 
    "assoc" => "ok"
];
$jsonxObj->add("array", $arr);
```

The JSON that will be generated by the given code will be similar to the following:


``` json 
{
    "array":[
        "one", 
        "two", 
        {
            "assoc":"ok"
        }
    ]
}
```

### Adding Arrays as Objects

It is possible to add arrays as objects to `JsonX` instance. This can be achived using the option `array-as-object` if the method [`JsonX::add()`](https://webfiori.com/docs/jsonx/JsonX#add) is used to add the array or by supplying `true` for the last argument if the method [`JsonX::addArray()`](https://webfiori.com/docs/jsonx/JsonX#addArray) is used.

Note that if the index is associative, its key will be used as property name. If the array is indexed, the names of the properties will be numbers.

> **Note:** If the array has sub-arrays and is added as object, sub arrays will also be added as objects.

#### Example 1: Indexed Array as Object
``` php
$jsonxObj = new JsonX();
$arr = ["one", "two", 3, 3.5, "hello"];
$jsonxObj->addArray("array", $arr, true);
```
``` json
{
    "array": {
        "0": "one",
        "1": "two",
        "2": 3,
        "3": 3.5,
        "4": "hello"
    }
}
```
#### Example 2: Associative Array as Object

``` php
$jsonxObj = new JsonX();
$arr = [
    "one"=>1, 
    "two"=>2, 
    "assoc" => "ok"
];
$jsonxObj->add("array", $arr, [
    'array-as-object' => true
]);
```
``` json 
{
    "array": {
        "one": 1,
        "two": 2,
        "assoc": true
    }
}
```

#### Example 3: Indexed and Associative Array as Object
``` php
$jsonxObj = new JsonX();
$arr = [
    "hello" => "World",
    "first-name" => "Ibrahim",
    "Random String",
    33,
    null,
    true,
    'is-good' => true,
    500
];
$jsonxObj->addArray("array", $arr, true);
```
``` json
{
    "array": {
        "hello": "World",
        "first-name": "Ibrahim",
        "0": "Random String",
        "1": 33,
        "2": null,
        "3": true,
        "is-good": true,
        "4": 500
    }
}
```

## Working With Objects

It is possible to add any object to an instance of `JsonX` but there is a catch here. If the object does not implement the interface [`JsonI`](https://webfiori.com/docs/jsonx/JsonI), then the properties that will be added will depend on the public `get` methods of the object. 

### Object Does not Implement `JsonI`

Let's assume that we would like to add an instance of the following class to an instance of `JsonX`:

``` php
class Employee {
    private $fName;
    private $lName;
    private $salary;
    public function __construct($fName, $lName, $salary) {
        $this->fName = $fName;
        $this->lName = $lName;
        $this->salary = $salary;
    }
    public function getFirstName() {
        return $this->fName;
    }
    public function getLastName() {
        return $this->lName;
    }
    public function getFullName() {
        return $this->getFirstName().' '.$this->getLastName();
    }
    public function salary() {
        return $this->salary;
    }
}
```
Assuming that we add the object as follows:
``` php
$jsonxObj = new JsonX();
$jsonxObj->addObject("obj", new \MyClass('Ibrahim', 'BinAlshikh', 7200));
```
The JSON output that will be created will be similar to the following:

``` json
{
    "obj": {
        "FirstName": "Ibrahim",
        "LastName": "BinAlshikh",
        "FullName": "Ibrahim BinAlshikh"
    }
}
```

What happend here is the following, the method [`JsonX::addObject()`](https://webfiori.com/docs/jsonx/JsonX#addObject) will try to access the public methods of the instance. After that, it will search for the methods that has the word `get` in there name. Based on that, it will detect the name of the property. If the name of the method is `getFirstName`, the name of the proprty will be `FirstName`.

> **Note:** The final name of the property will depend on the style of the properties names. For example, if properties style is set to `snake`, then the name of the proprty `LastName` would be `last_name`.

### Object Implement `JsonI`

## Converting JSON String to JsonX
## Properties Style


